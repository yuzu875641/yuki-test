<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="robots" content="noindex,nofollow">
    <title>勉強に集中したい！勉強への集中力をアップする方法とは？</title>
    <link rel="icon" href="/img/logo/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=thumb_up" />
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="/js/utils/utils.js"></script>
    <script>
        $(document).ready(function() {
            $("#hamburger").click(function() {
                $("#top-nav").toggleClass("show");
            });
            $(window).on("scroll", function() {
                if ($(window).scrollTop() > 50) {
                    $("#top-bar").addClass("scrolled");
                } else {
                    $("#top-bar").removeClass("scrolled");
                }
            });
        });
    </script>
    <style>
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
        }
        .ui-menu .ui-menu-item {
            font-size: 1rem;
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
            background-color: #2D3748;
            border: none;
            color: #E2E8F0;
        }
        .ui-menu .ui-menu-item:hover, .ui-menu .ui-menu-item-active {
            background-color: #4A5568;
        }
        .ui-autocomplete {
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .thumbnail {
            position: relative;
            width: 100%;
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .length {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>

<body class="bg-gray-900 text-gray-200 min-h-screen">
    <header class="p-6 md:p-8 bg-gray-800 rounded-3xl shadow-2xl flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0 sticky top-0 z-50">
        <div class="text-center md:text-left flex items-center space-x-4">
            <a href="/">
                <img src="/img/logo/th.png" alt="Logo" class="h-8">
            </a>
            <h1 class="text-xl font-bold text-blue-400 hidden md:block">Yuki Youtube</h1>
        </div>
        <div class="w-full md:w-1/2 relative">
            <form id="searchForm" class="w-full relative" action="/search" method="get">
                <input type="search" id="searchbox" class="w-full py-2 px-4 rounded-full bg-gray-700 text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-300" autocomplete="on" autocorrect="on" autocapitalize="none" spellcheck="false" name="q" placeholder="検索" title="検索" value="">
                <button type="submit" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-blue-500 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                    </svg>
                </button>
            </form>
        </div>
        <nav id="top-nav" class="hidden md:flex items-center space-x-4">
            <a href="/bbs" class="text-gray-400 hover:text-blue-400 transition-colors duration-200">掲示板</a>
            <a href="/proxypage" class="text-gray-400 hover:text-blue-400 transition-colors duration-200">Proxy</a>
            <a href="/others" class="text-gray-400 hover:text-blue-400 transition-colors duration-200">その他</a>
            <a href="/sitsumon" class="text-gray-400 hover:text-blue-400 transition-colors duration-200">回答よろ</a>
        </nav>
        <button id="open-sidebar" class="md:hidden text-gray-400 hover:text-blue-400 text-2xl">☰</button>
    </header>

    <div id="sidebar" class="fixed top-0 left-0 h-full w-64 bg-gray-900 shadow-xl z-[1100] transform -translate-x-full transition-transform ease-in-out duration-300">
        <div class="p-4 border-b border-gray-700 flex justify-end">
            <button id="close-sidebar" class="text-gray-400 hover:text-blue-400 text-2xl">&times;</button>
        </div>
        <div class="sidebar-content flex flex-col p-4 space-y-4">
            <a href="/bbs" class="hover:text-blue-400">掲示板</a>
            <a href="/proxypage" class="hover:text-blue-400">Proxy</a>
            <a href="/others" class="hover:text-blue-400">その他</a>
            <a href="/sitsumon" class="hover:text-blue-400">回答よろ</a>
            <hr class="border-gray-700">
            <a href="{{ videourls[0] }}" download="{{ video_title }}" class="hover:text-blue-400">ダウンロード</a>
            <a href="javascript:location.replace('/watch?v={{ videoid }}')" class="hover:text-blue-400">デフォルトで視聴する</a>
            <a href="javascript:location.replace('/ume?v={{ videoid }}')" class="hover:text-blue-400">埋め込み(nocookie)で視聴する</a>
            <a href="javascript:location.replace('/w?v={{ videoid }}')" class="hover:text-blue-400">高画質で視聴する</a>
            <a href="javascript:location.replace('/history')" class="hover:text-blue-400">履歴を閲覧</a>
            <label class="flex items-center space-x-2 cursor-pointer text-gray-400">
                <input id="autonextpage" type="checkbox" onchange="changeAutoNextPage(this)" class="form-checkbox h-4 w-4 text-blue-600 rounded">
                <span>自動で次の動画に遷移</span>
            </label>
            <label class="flex items-center space-x-2 cursor-pointer text-gray-400">
                <input id="loop" type="checkbox" onchange="changeLoop(this)" class="form-checkbox h-4 w-4 text-blue-600 rounded">
                <span>ループ再生</span>
            </label>
        </div>
    </div>
    <div id="overlay" class="fixed inset-0 bg-black opacity-0 z-[900] pointer-events-none transition-opacity duration-300"></div>

    <main class="container mx-auto mt-8 px-4 lg:flex lg:space-x-8">
        <div class="lg:w-2/3 space-y-8">
            <div class="bg-gray-800 rounded-xl shadow-lg overflow-hidden relative">
                <div class="video-player-wrapper aspect-video w-full">
                    <iframe width="100%" height="100%" src="https://www.youtube-nocookie.com/embed/{{ videoid }}" title="video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                    <div id="loader" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-16 h-16 border-4 border-t-blue-500 border-gray-700 rounded-full animate-spin hidden"></div>
                </div>
            </div>
            <div class="bg-gray-800 p-6 rounded-xl shadow-lg space-y-4">
                <h1 class="text-xl sm:text-2xl font-bold text-gray-200">{{ video_title }}</h1>
                <div class="flex items-center space-x-4 text-sm text-gray-400">
                    <span>{{ view_count }}回視聴</span>
                    <div class="flex items-center space-x-1">
                        <span class="material-symbols-outlined text-blue-400">thumb_up</span>
                        <span>{{ like_count }}</span>
                    </div>
                </div>
                <div id="descriptionText" class="mt-4 text-sm text-gray-400 leading-relaxed">
                    <p>{{ description | safe }}</p>
                </div>
            </div>
            <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
                <h3 class="text-xl font-bold mb-4">コメント</h3>
                <div id="comments"></div>
            </div>
        </div>

        <div class="lg:w-1/3 mt-8 lg:mt-0 space-y-4">
            <h3 class="text-xl font-bold mb-4">関連動画</h3>
            {% for rec_video in recommended_videos %}
            <a href="/ume?v={{ rec_video['video_id'] }}" class="block transform hover:scale-105 transition-transform duration-300">
                <div class="bg-gray-800 rounded-xl shadow-md p-4 space-y-2">
                    <div class="relative overflow-hidden rounded-lg">
                        <img loading="lazy" class="w-full h-auto object-cover" src="{% if proxy == 'True' %}/thumbnail?v={{ rec_video['video_id'] }}{% else %}https://img.youtube.com/vi/{{ rec_video['video_id'] }}/0.jpg{% endif %}" alt="{{ rec_video['title'] }}">
                        <span class="length">{{ rec_video["length_text"] }}</span>
                    </div>
                    <p class="font-semibold text-sm leading-tight text-gray-200">{{ rec_video["title"] }}</p>
                    <div class="flex items-center text-xs text-gray-400">
                        <a href="/channel/{{ rec_video['authorId'] }}" class="hover:underline">{{ rec_video["author"] }}</a>
                        <span class="mx-2">•</span>
                        <span>{{ rec_video["view_count_text"] }}回視聴</span>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </main>
    
    <script>
        const openSidebar = document.getElementById("open-sidebar");
        const closeSidebar = document.getElementById("close-sidebar");
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("overlay");
        
        openSidebar.addEventListener("click", () => {
            sidebar.classList.add("translate-x-0");
            overlay.classList.remove("pointer-events-none", "opacity-0");
            overlay.classList.add("opacity-50");
        });
        
        const closeSidebarFunc = () => {
            sidebar.classList.remove("translate-x-0");
            overlay.classList.remove("opacity-50");
            overlay.classList.add("pointer-events-none", "opacity-0");
        };
        
        closeSidebar.addEventListener("click", closeSidebarFunc);
        overlay.addEventListener("click", closeSidebarFunc);
        
        const xhr = new XMLHttpRequest();
        xhr.open("GET", "/comments?v=" + getQueryValue('v'));
        xhr.onload = function () {
            if (xhr.status == 200) {
                const comments_div = document.getElementById('comments');
                comments_div.innerHTML = xhr.responseText;
                const comments_a_tags = comments_div.getElementsByTagName('a');
                for (let i = 0; i < comments_a_tags.length; i++) {
                    const jump_time = comments_a_tags[i].getAttribute('data-jump-time');
                    if (jump_time) {
                        comments_a_tags[i].addEventListener('click', function(e) {
                            e.preventDefault();
                            player.currentTime = jump_time;
                        });
                    }
                }
            } else {
                document.getElementById('comments').innerHTML = "コメントの読み込みに失敗しました。再読み込み等をお試し下さい。";
            }
        };
        xhr.send();
        
        const haveLoopCookie = getCookie("loop") === 'true' ? true : false;
        document.getElementById("loop").checked = haveLoopCookie;
        document.getElementById("autonextpage").checked = getCookie("autonextpage") === 'true' ? true : false;
        
        function changeAutoNextPage(checkbox) {
            document.cookie = `autonextpage=${checkbox.checked}; path=/; max-age=10800;`;
        }
        
        function autoNextPage() {
            const enable_autoNextPage = document.getElementById('autonextpage').checked;
            document.cookie = `autonextpage=${enable_autoNextPage}; max-age=10800;`;
            if (enable_autoNextPage) {
                setTimeout(() => {
                    location.replace("/watch?v={{ recommended_videos[0]['video_id'] }}");
                }, 5000);
            }
        }
        
        function changeLoop(checkbox) {
            const enable_loop = checkbox.checked;
            document.getElementById("player").loop = enable_loop;
            document.cookie = `loop=${enable_loop}; path=/; max-age=10800;`;
        }
        
        function keydown(key) {
            if (key.keyCode == 32 || key.keyCode == 75) {
                const v = document.getElementById("player");
                if (v.paused === true) {
                    v.play();
                } else {
                    v.pause();
                }
            }
        }
        window.addEventListener('keydown', keydown);
        
        function addToHistory() {
            const videoData = {
                video_id: "{{ videoid }}",
                thumbnail: "{% if proxy == 'True' %}/thumbnail?v={{ videoid }}{% else %}https://img.youtube.com/vi/{{ videoid }}/0.jpg{% endif %}",
                length: "{{ length_text }}",
                title: "{{ video_title }}",
                channel: "{{ author }}",
                channel_id: "{{ author_id }}",
                view_count: "{{ view_count }}",
                published: "{{ published_date }}"
            };
            let history = localStorage.getItem('watchHistory');
            history = history ? JSON.parse(history) : [];
            history = history.filter(item => item.video_id !== videoData.video_id);
            history.unshift(videoData);
            if (history.length > 50) {
                history = history.slice(0, 50);
            }
            localStorage.setItem('watchHistory', JSON.stringify(history));
        }
        window.addEventListener('load', addToHistory);
    </script>
</body>
  </html>
