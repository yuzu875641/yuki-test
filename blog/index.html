<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset='utf-8'>
    <title>しぐれうい</title>
    <style>
      body {
        margin: 0;
        padding: 20px;
        background-color: #f0f0f0;
        font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background-color: #fff;
        padding-bottom: 20px;
      }
      .video-container {
        position: relative;
        width: 100%;
        padding-bottom: 56.25%; /* 16:9のアスペクト比 */
        height: 0;
        overflow: hidden;
      }
      .video-container iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
      .video-title {
        padding: 15px;
        font-size: 1.2em;
        font-weight: bold;
        color: #030303;
      }
      .info-bar {
        display: flex;
        justify-content: space-around;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px solid #ddd;
      }
      .info-item {
        text-align: center;
        color: #606060;
      }
      .info-item .value {
        font-weight: bold;
        font-size: 1.1em;
        color: #030303;
      }
      .description-box {
        padding: 15px;
        line-height: 1.6;
        color: #030303;
        white-space: pre-wrap;
      }
      .description-box a {
        color: #065fd4;
        text-decoration: none;
      }
      .description-box a:hover {
        text-decoration: underline;
      }
      #comments-section {
        padding: 15px;
      }
      .comment-item {
        border-bottom: 1px solid #eee;
        padding: 10px 0;
      }
      .comment-author {
        font-weight: bold;
        color: #030303;
      }
      .comment-content {
        color: #606060;
      }
    </style>
</head>
<body>
    <p>とりあえず漁ってきたのを改造したやつ</p>
    <input id="word" type="text" /><input type="button" value="確認" onClick="getlevel()" />
    <div id="info"></div>

    <script>
        function getlevel() {
            if (document.getElementById('word').value === "0530") {
                document.cookie = "yuki=True; path=/;";
                window.location.href = "/"
            } else {
                // ここでは何もしない
            }
        }
        
        function displayVideoAndComments() {
            const infoDiv = document.getElementById('info');
            infoDiv.innerHTML = `
                <div class="container">
                    <div class="video-container">
                        <iframe src="https://www.youtube-nocookie.com/embed/e-qWitCw9dU" title="チェリーポップ /covered by しぐれうい" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                    </div>

                    <div class="video-title">
                        チェリーポップ /covered by しぐれうい
                    </div>

                    <div class="info-bar">
                        <div class="info-item">
                            <div class="value" id="likes-count"></div>
                            <div>高評価数</div>
                        </div>
                        <div class="info-item">
                            <div class="value" id="views-count"></div>
                            <div>視聴回数</div>
                        </div>
                        <div class="info-item">
                            <div class="value" id="published-date"></div>
                            <div>公開日</div>
                        </div>
                    </div>

                    <div class="description-box">
🍒チェリーポップ
原曲：   DECO*27 - チェリーポップ feat. 初音ミク  
Lyrics & Music: DECO*27
Arrangement: DECO*27 & Hayato Yamamoto
© OTOIRO / DECO27

Mix: 宮沢竣介
カバー映像：ご本家の映像素材をお借りしています！
（お手伝いいただいた方：神稲たーむ）
イラスト&歌：しぐれうい
                    </div>

                    <div id="comments-section">
                        <h3>コメント</h3>
                        <p>コメントを読み込み中...</p>
                    </div>
                </div>
            `;
            
            // API呼び出しの実行
            const videoId = 'e-qWitCw9dU';
            const invidiousUrl = 'https://invidious.nikkosphere.com';

            Promise.all([
                fetch(`${invidiousUrl}/api/v1/videos/${videoId}`),
                fetch(`${invidiousUrl}/api/v1/comments/${videoId}`)
            ])
            .then(responses => {
                return Promise.all(responses.map(response => {
                    if (!response.ok) {
                        throw new Error('データの取得に失敗しました。');
                    }
                    return response.json();
                }));
            })
            .then(data => {
                const videoData = data[0];
                const commentsData = data[1];

                // 動画情報の表示
                document.getElementById('likes-count').textContent = videoData.likeCount.toLocaleString();
                document.getElementById('views-count').textContent = videoData.viewCount.toLocaleString();
                
                const publishedDate = new Date(videoData.published * 1000);
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('published-date').textContent = publishedDate.toLocaleDateString('ja-JP', options);

                // コメントの表示
                const commentsSection = document.getElementById('comments-section');
                const loadingText = commentsSection.querySelector('p');
                if (loadingText) {
                    loadingText.remove();
                }
                commentsData.comments.forEach(comment => {
                    const commentDiv = document.createElement('div');
                    commentDiv.className = 'comment-item';
                    commentDiv.innerHTML = `
                        <div class="comment-author">${comment.author}</div>
                        <div class="comment-content">${comment.content}</div>
                    `;
                    commentsSection.appendChild(commentDiv);
                });
            })
            .catch(error => {
                console.error('データの取得エラー:', error);
                document.getElementById('comments-section').innerHTML = '<h3>コメント</h3><p>データの読み込みに失敗しました。</p>';
            });
        }
        
        // ページ読み込み完了時に動画を表示
        document.addEventListener('DOMContentLoaded', displayVideoAndComments);
    </script>
</body>
</html>

